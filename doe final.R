N=matrix(c(1,1,1,0,0,
           1,1,0,1,0,
           1,1,0,0,1,
           1,0,1,1,0,
           1,0,1,0,1,
           1,0,0,1,1,
           0,1,1,1,0,
           0,1,1,0,1,
           0,1,0,1,1,
           0,0,1,1,1), ncol= 10, byrow= F)
N
t(N)

I10<- diag(10)
I10

D<-matrix(c(27,26,30,0,0,
            28,26,0,29,0,
            30,29,0,0,26,
            31,0,34,33,0,
            29,0,32,0,24,
            30,0,0,34,25,
            0,30,34,31,0,
            0,21,31,0,23,
            0,26,0,33,24,
            0,0,33,31,26),nrow= 5, byrow = F)
D

T<-rowSums(D)
T

B<-colSums(D)
B

Q<- T- N %*% (1/3 * I10) %*% B
Q

SSB<-sum(Q^2)/5

SSB 

G<-sum(T)
G

n<- 30

SST<-sum(B^2)/3 - G^2/n
SST

y<-c(27,26,30,0,0,
     28,26,0,29,0,
     30,29,0,0,26,
     31,0,34,33,0,
     29,0,32,0,24,
     30,0,0,34,25,
     0,30,34,31,0,
     0,21,31,0,23,
     0,26,0,33,24,
     0,0,33,31,26)

SSTotal<- sum(y^2) - G^2/n
SSTotal

SSTotal-SST-SSB
